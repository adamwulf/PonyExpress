{"primaryContentSections":[{"kind":"content","content":[{"anchor":"The-Problem","level":2,"type":"heading","text":"The Problem"},{"type":"paragraph","inlineContent":[{"type":"text","text":"When sending a notification with "},{"type":"codeVoice","code":"NotificationCenter"},{"type":"text","text":", all information needs to be encoded"},{"type":"text","text":" "},{"type":"text","text":"into a "},{"type":"codeVoice","code":"[String: Any]"},{"type":"text","text":" "},{"type":"codeVoice","code":"userInfo"},{"type":"text","text":" object attached to the notification. Sending all data through"},{"type":"text","text":" "},{"type":"text","text":"arbitrary string keys presents a few problems:"}]},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Thereâ€™s no compiler support to help catch mistakes or typos in a "},{"type":"codeVoice","code":"String"},{"type":"text","text":" key name"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"A wrongly typed object for a key will either silently fail at runtime if checked with "},{"type":"codeVoice","code":"as? MyType"},{"type":"text","text":","}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"or, the above will crash at runtime when using "},{"type":"codeVoice","code":"as! MyType"},{"type":"text","text":". Either way, there is no compile-time"},{"type":"text","text":" "},{"type":"text","text":"support for notification types"}]}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"All of these problems are from the observer silently failing at runtime, instead of loudly failing"},{"type":"text","text":" "},{"type":"text","text":"at compile-time."}]},{"anchor":"The-Solution","level":2,"type":"heading","text":"The Solution"},{"type":"paragraph","inlineContent":[{"type":"text","text":"With "},{"type":"codeVoice","code":"PonyExpress"},{"type":"text","text":", the notification is type-safe and guaranteed at compile-time to"},{"type":"text","text":" "},{"type":"text","text":"match the observer site."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Instead of observing with a type-erased "},{"type":"codeVoice","code":"#selector"},{"type":"text","text":", all observers in PonyExpress are strongly"},{"type":"text","text":" "},{"type":"text","text":"typed. The example below registers a method to listen for MyNotification objects:"}]},{"type":"codeListing","syntax":null,"code":["class ExampleRecipient {","    init {","        PostOffice.default.register(self, ExampleRecipient.receiveNotification)","    }","","    func receiveNotification(notification: ExampleNotification) {","        count += 1","        testBlock?()","    }","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"When sending notifications, "},{"type":"codeVoice","code":"NotificationCenter"},{"type":"text","text":" only provides an optional "},{"type":"codeVoice","code":"[AnyHashable: Any]?"},{"type":"text","text":" "},{"type":"codeVoice","code":"userInfo"},{"type":"text","text":" object for the "},{"type":"codeVoice","code":"Notification"},{"type":"text","text":". Unfortunately, this requires casting at the"},{"type":"text","text":" "},{"type":"text","text":"observer site. If the "},{"type":"codeVoice","code":"userInfo"},{"type":"text","text":" format ever changes for a notification, there is no"},{"type":"text","text":" "},{"type":"text","text":"compile-time check that all observers expect the new format."}]},{"anchor":"Send-Anything","level":3,"type":"heading","text":"Send Anything"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Anything can be sent as a"}]},{"anchor":"Example","level":3,"type":"heading","text":"Example"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The following snippet shows how to initialize a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/PonyExpress\/documentation\/PonyExpress\/PostOffice"},{"type":"text","text":" to send an "},{"type":"codeVoice","code":"Int"},{"type":"text","text":" "},{"type":"text","text":"along with each notification. An observer block is added, and finally a notification"},{"type":"text","text":" "},{"type":"text","text":"is sent with the "},{"type":"codeVoice","code":"PonyExpress\/PonyExpress\/post(_:sender:contents:)"},{"type":"text","text":" method."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Below is an example of creating a custom notification type, listening for and then sending"},{"type":"text","text":" "},{"type":"text","text":"that type."}]},{"type":"codeListing","syntax":"swift","code":["\/\/ Define a notification that we can send","struct MyImportantNotification {","    let fumble: Int","    let bumble: Float","}","","\/\/ Listen for a `MyImportantNotification`","postOffice.register({ (notification: MyImportantNotification) in","    \/\/ process notification","})","","\/\/ Send a MyImportantNotification","postOffice.post(MyImportantNotification(fumble: 12, bumble: 14))"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"For convenience, any type can be wrapped in a "},{"type":"codeVoice","code":"Package"},{"type":"text","text":" and sent through a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/PonyExpress\/documentation\/PonyExpress\/PostOffice"}]},{"type":"codeListing","syntax":"swift","code":["\/\/ Create a `PostOffice`","let postOffice = PostOffice()","","\/\/ Listen for packages","postOffice.register({ (notification: Package<Int>) in","    \/\/ process notification","})","","\/\/ Send a notification","postOffice.post(Package<Int>(contents: 12))"]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/ponyexpress"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/PonyExpress\/documentation\/PonyExpress","interfaceLanguage":"swift"},"abstract":[{"type":"codeVoice","code":"PonyExpress"},{"type":"text","text":" provides a type-safe alternative to "},{"type":"codeVoice","code":"NotificationCenter"},{"type":"text","text":". Inspired by"},{"type":"text","text":" "},{"type":"text","text":"https:\/\/en.wikipedia.org\/wiki\/Pony_Express."}],"kind":"symbol","metadata":{"roleHeading":"Framework","externalID":"PonyExpress","title":"PonyExpress","symbolKind":"module","role":"collection","modules":[{"name":"PonyExpress"}]},"hierarchy":{"paths":[[]]},"topicSections":[{"title":"Classes","identifiers":["doc:\/\/PonyExpress\/documentation\/PonyExpress\/PostOffice"]},{"title":"Structures","identifiers":["doc:\/\/PonyExpress\/documentation\/PonyExpress\/RecipientId"]}],"references":{"doc://PonyExpress/documentation/PonyExpress":{"role":"collection","title":"PonyExpress","abstract":[{"type":"codeVoice","code":"PonyExpress"},{"type":"text","text":" provides a type-safe alternative to "},{"type":"codeVoice","code":"NotificationCenter"},{"type":"text","text":". Inspired by"},{"type":"text","text":" "},{"type":"text","text":"https:\/\/en.wikipedia.org\/wiki\/Pony_Express."}],"identifier":"doc:\/\/PonyExpress\/documentation\/PonyExpress","kind":"symbol","type":"topic","url":"\/documentation\/ponyexpress"},"doc://PonyExpress/documentation/PonyExpress/PostOffice":{"role":"symbol","title":"PostOffice","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"PostOffice"}],"abstract":[],"identifier":"doc:\/\/PonyExpress\/documentation\/PonyExpress\/PostOffice","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"PostOffice"}],"url":"\/documentation\/ponyexpress\/postoffice"},"doc://PonyExpress/documentation/PonyExpress/RecipientId":{"role":"symbol","title":"RecipientId","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"RecipientId"}],"abstract":[{"type":"text","text":"An opaque value that represents a specific recipient registered at a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/PonyExpress\/documentation\/PonyExpress\/PostOffice"},{"type":"text","text":"."}],"identifier":"doc:\/\/PonyExpress\/documentation\/PonyExpress\/RecipientId","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"RecipientId"}],"url":"\/documentation\/ponyexpress\/recipientid"}}}